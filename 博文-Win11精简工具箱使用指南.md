# Win11 精简工具箱：让系统更轻更快的一体化解决方案

> 作者：黑客驰 | 发布时间：2024 | 来源：hackerchi.top

## 前言

Windows 11 系统虽然功能强大，但预装了许多用户可能不需要的应用和服务，这些应用不仅占用磁盘空间，还会在后台运行消耗系统资源。如果你想让系统更轻、更快，那么今天介绍的 **Win11 精简工具箱（CTT）** 就是你的不二之选。

## 什么是 Win11 精简工具箱？

Win11 精简工具箱是一个功能强大的 PowerShell 脚本工具，提供了菜单式操作界面，集成了系统精简、备份、还原、空间估算、前后对比等多项功能。它可以帮助你：

- 🗑️ 安全卸载不需要的预装应用
- 📦 导出完整的系统配置备份
- 🔄 创建系统还原点
- 📊 预估和对比空间节省情况
- ⚙️ 禁用不必要的服务和计划任务
- 💾 保存和加载自定义配置方案

## 核心功能详解

### 1. 三种预设精简方案

工具箱提供了三种预设方案，满足不同用户的需求：

#### 保守方案（推荐新手）
卸载 11 个常见的非必需应用，包括：
- 新闻、天气、帮助等资讯类应用
- 游戏类应用（如纸牌游戏）
- 社交类应用（如 People、Todos）

**适合人群**：想要轻度精简，保留大部分功能的用户

#### 中度方案
在保守方案基础上，额外卸载：
- Power Automate Desktop（自动化工具）
- Microsoft Teams（团队协作）
- Quick Assist（远程协助）

**适合人群**：需要更多空间，但不想过度精简的用户

#### 激进方案
在中度方案基础上，额外卸载：
- Windows Camera（相机应用）
- Windows Sound Recorder（录音机）
- Your Phone（手机连接）

**适合人群**：追求极致精简，最大化释放空间的用户

### 2. 备份与还原功能

#### 创建系统还原点
在执行任何精简操作前，工具箱会提示你创建系统还原点。这是最安全的保障，如果出现问题，可以快速恢复到操作前的状态。

#### 导出备份清单
工具箱会导出以下内容的完整清单：
- **Appx 应用包**：所有已安装的应用包信息
- **可选功能**：Windows 可选功能状态
- **系统能力**：已安装的系统能力
- **服务列表**：所有系统服务及其状态
- **计划任务**：所有计划任务列表
- **当前配置**：你使用的精简配置

这些清单以 CSV 和 JSON 格式保存，方便后续查看和恢复。

### 3. 空间估算与对比

#### 预计节省报告
在执行精简前，工具箱会根据你的配置估算可能释放的空间：
- 计算所有待卸载 Appx 的安装目录大小
- 估算 OneDrive 程序本体大小（不含同步文件）
- 提供性能预期说明

#### 前后对比功能
这是工具箱的亮点功能之一：
1. **记录基线**：在执行精简前记录 C 盘可用空间
2. **执行精简**：按配置执行卸载操作
3. **查看对比**：执行后查看真实的空间变化

这样你就能准确知道实际释放了多少空间，而不是仅仅看估算值。

### 4. DryRun 预演模式

这是一个非常实用的安全功能。开启 DryRun 模式后：
- 所有操作都不会真正执行
- 会显示将要执行的操作命令
- 可以安全地测试整个流程

**建议**：首次使用或修改配置后，先开启 DryRun 模式测试一遍。

### 5. 配置管理

工具箱支持保存和加载配置方案：
- 可以将当前配置保存为 JSON 文件
- 下次使用时可以直接加载
- 方便在不同设备间共享配置

## 使用教程

### 第一步：准备工作

1. **下载脚本**
   ```powershell
   # 从 GitHub 下载或克隆仓库
   git clone https://github.com/HackerChi-Hub/CTT.git
   cd CTT
   ```

2. **以管理员身份运行 PowerShell**
   - 右键点击 PowerShell
   - 选择"以管理员身份运行"
   - 导航到脚本目录

### 第二步：首次运行

```powershell
# 运行脚本
.\main.ps1
```

首次运行会看到菜单界面，显示所有可用功能。

### 第三步：推荐操作流程

#### 1️⃣ 创建系统还原点（菜单 1）

这是最重要的安全步骤！即使后续出现问题，也能快速恢复。

```
选择：1
等待：系统创建还原点（可能需要几分钟）
结果：看到"已创建系统还原点"提示
```

#### 2️⃣ 导出备份清单（菜单 2）

导出当前系统的完整配置，保存到工作目录的 `backup_YYYYMMDD_HHMMSS` 文件夹。

```
选择：2
等待：导出过程（几秒到几分钟，取决于系统）
结果：在 C:\HackerChi-Win11Toolkit\backup_* 目录查看导出的文件
```

#### 3️⃣ 记录空间基线（菜单 15，选择 1）

在执行精简前记录当前 C 盘可用空间，用于后续对比。

```
选择：15
子选项：1
结果：基线已保存到 baseline_space.json
```

#### 4️⃣ 查看预计报告（菜单 14）

查看根据当前配置估算的空间节省情况。

```
选择：14
查看：预计可释放的空间和性能预期
```

#### 5️⃣ 开启 DryRun 模式（菜单 11，可选但推荐）

首次使用建议先开启预演模式，查看将要执行的操作。

```
选择：11
结果：DryRun 已切换为：True
```

#### 6️⃣ 选择预设方案并执行（菜单 3）

选择适合你的精简方案：

```
选择：3
输入等级：1（保守）/ 2（中度）/ 3（激进）
确认：查看配置预览，输入 y 确认执行
等待：执行过程（可能需要几分钟）
```

#### 7️⃣ 重启系统

执行完成后，建议重启系统以确保所有更改生效。

#### 8️⃣ 查看空间对比（菜单 15，选择 2）

重启后，查看实际释放的空间：

```
选择：15
子选项：2
查看：执行前后的空间对比报告
```

### 高级用法

#### 自定义卸载 Appx（菜单 4）

如果你想卸载预设方案中没有的应用：

```
选择：4
输入包名：Microsoft.YourPhone,MicrosoftTeams
（多个用英文逗号分隔）
```

如何查找 Appx 包名？
```powershell
# 在 PowerShell 中运行
Get-AppxPackage -AllUsers | Select-Object Name, PackageFullName | Format-Table
```

#### 禁用计划任务和服务（菜单 5、6）

工具箱预设了一些可以安全禁用的计划任务和服务：
- 客户体验改善计划相关任务
- 遥测服务（DiagTrack）

你可以查看列表后选择是否执行。

#### 卸载 OneDrive（菜单 7）

如果你不使用 OneDrive，可以一键卸载：

```
选择：7
结果：切换 RemoveOneDrive 开关
如果开启：会询问是否立即执行卸载
```

#### 恢复内置 Appx（菜单 8）

如果误删了应用，可以尝试恢复：

```
选择：8
结果：重新注册系统中现存的 Appx
注意：这不等同于从商店重装，只能恢复未完全删除的应用
```

#### 保存和加载配置（菜单 12）

保存当前配置：
```
选择：12
子选项：1
结果：配置保存到 config.json
```

加载已保存的配置：
```
选择：12
子选项：2
结果：从 config.json 加载配置
```

## 实际效果展示

### 空间节省

根据实际测试：
- **保守方案**：通常可释放 500MB - 1.5GB
- **中度方案**：通常可释放 1GB - 2.5GB
- **激进方案**：通常可释放 1.5GB - 3.5GB

*实际效果因系统配置和已安装应用而异*

### 性能提升

- **后台占用**：减少 0-3% CPU 占用
- **内存占用**：减少 20-150MB 内存
- **启动速度**：略微提升（取决于卸载的应用数量）
- **系统响应**：更"安静"，后台活动减少

## 注意事项与最佳实践

### ⚠️ 重要提示

1. **必须创建还原点**：这是最重要的安全措施
2. **先备份再操作**：导出备份清单，以防万一
3. **首次使用建议 DryRun**：先预演，确认无误再执行
4. **选择合适方案**：新手建议从保守方案开始
5. **不要过度精简**：某些应用可能被其他功能依赖

### ✅ 最佳实践

1. **按推荐流程操作**：1→2→15-1→14→3→重启→15-2
2. **保存配置**：找到合适的配置后，保存以便后续使用
3. **定期查看日志**：操作记录在 `toolkit.log` 中
4. **保留备份**：备份清单和配置文件要妥善保存

### ❌ 常见错误

1. **忘记创建还原点**：这是最大的风险
2. **直接选择激进方案**：可能误删需要的应用
3. **不查看配置就执行**：建议先看菜单 13 查看当前配置
4. **执行后不重启**：某些更改需要重启才能生效

## 故障排除

### 问题1：无法创建还原点

**原因**：
- 系统保护未启用
- 磁盘空间不足
- 系统还原服务未运行

**解决方法**：
1. 检查系统保护：`系统属性 → 系统保护 → 配置`
2. 确保 C 盘有足够空间（建议至少 1GB）
3. 检查服务：`services.msc → Volume Shadow Copy`

### 问题2：Appx 卸载失败

**原因**：
- 应用正在运行
- 应用是系统核心组件
- 权限不足

**解决方法**：
1. 关闭相关应用后再试
2. 某些应用（如 Microsoft Store）无法卸载是正常的
3. 确保以管理员身份运行

### 问题3：空间对比显示为 0

**原因**：
- 未记录基线就执行了精简
- 执行后未重启系统

**解决方法**：
1. 下次使用记得先记录基线（菜单 15-1）
2. 执行精简后重启系统，再查看对比

## 技术细节

### 工作目录结构

```
C:\HackerChi-Win11Toolkit\
├── toolkit.log              # 操作日志
├── config.json              # 保存的配置
├── baseline_space.json      # 空间基线
└── backup_YYYYMMDD_HHMMSS/  # 备份清单目录
    ├── appx_allusers.csv
    ├── optional_features.csv
    ├── capabilities.csv
    ├── services.csv
    ├── scheduled_tasks.csv
    └── config_used.json
```

### 配置格式

配置文件采用 JSON 格式：

```json
{
  "RemoveAppx": [
    "Microsoft.BingNews",
    "Microsoft.BingWeather"
  ],
  "DisableScheduledTasks": [
    "\\Microsoft\\Windows\\Application Experience\\ProgramDataUpdater"
  ],
  "DisableServices": [
    "DiagTrack"
  ],
  "RemoveOneDrive": false
}
```

## 总结

Win11 精简工具箱是一个功能完善、安全可靠的系统优化工具。它提供了：

✅ **安全性**：还原点 + 备份清单 + DryRun 模式  
✅ **易用性**：菜单式操作，无需记忆命令  
✅ **灵活性**：预设方案 + 自定义配置  
✅ **可追溯性**：详细日志 + 前后对比  

无论你是想要轻度精简的新手，还是追求极致优化的高级用户，这个工具箱都能满足你的需求。

记住：**安全第一，先备份再操作！**

---

## 相关资源

- 📦 GitHub 仓库：https://github.com/HackerChi-Hub/CTT
- 📖 完整文档：查看 README.md
- 🌐 作者网站：hackerchi.top

## 更新日志

- **v1.0**：初始版本，包含核心精简功能
- 支持三种预设方案
- 支持备份和还原
- 支持空间估算和对比

---

**免责声明**：本工具会修改系统应用/服务/计划任务。使用前请创建还原点并导出备份。使用本工具产生的任何后果由用户自行承担。

© 2024 黑客驰 | hackerchi.top All Rights Reserved
